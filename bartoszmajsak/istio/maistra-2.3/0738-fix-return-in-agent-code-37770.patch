From b67768b51e2780f486ef80525b3767814d1b3278 Mon Sep 17 00:00:00 2001
From: Rama Chavali <rama.rao@salesforce.com>
Date: Mon, 7 Mar 2022 20:33:00 +0530
Subject: fix return in agent code (#37770)

* fix return in agent code

Signed-off-by: Rama Chavali <rama.rao@salesforce.com>

* lint

Signed-off-by: Rama Chavali <rama.rao@salesforce.com>
---
 pkg/istio-agent/agent.go | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/pkg/istio-agent/agent.go b/pkg/istio-agent/agent.go
index a08554709f..eaffc1c8fb 100644
--- a/pkg/istio-agent/agent.go
+++ b/pkg/istio-agent/agent.go
@@ -202,8 +202,7 @@ type AgentOptions struct {
 // NewAgent hosts the functionality for local SDS and XDS. This consists of the local SDS server and
 // associated clients to sign certificates (when not using files), and the local XDS proxy (including
 // health checking for VMs and DNS proxying).
-func NewAgent(proxyConfig *mesh.ProxyConfig, agentOpts *AgentOptions, sopts *security.Options,
-	eopts envoy.ProxyConfig) *Agent {
+func NewAgent(proxyConfig *mesh.ProxyConfig, agentOpts *AgentOptions, sopts *security.Options, eopts envoy.ProxyConfig) *Agent {
 	return &Agent{
 		proxyConfig:   proxyConfig,
 		cfg:           agentOpts,
@@ -333,7 +332,7 @@ func (a *Agent) initializeEnvoyAgent(ctx context.Context) error {
 				log.Infof("retrying bootstrap discovery request with backoff: %v", delay)
 				select {
 				case <-ctx.Done():
-					break
+					break retries
 				case <-time.After(delay):
 				}
 				if backoff < max/2 {
-- 
2.35.3

