From 6fafe239e8f1be032904977f6d5722c5ccefd0fe Mon Sep 17 00:00:00 2001
From: AdamKorcz <44787359+AdamKorcz@users.noreply.github.com>
Date: Tue, 7 Dec 2021 20:06:29 +0000
Subject: Fuzzing: Fix OSS-fuzz issue 41589 (#36408)

---
 tests/fuzz/ca_server_fuzzer.go | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/tests/fuzz/ca_server_fuzzer.go b/tests/fuzz/ca_server_fuzzer.go
index 32a8597643..078996c8ee 100644
--- a/tests/fuzz/ca_server_fuzzer.go
+++ b/tests/fuzz/ca_server_fuzzer.go
@@ -20,10 +20,13 @@
 
 import (
 	"context"
+	"fmt"
 
 	pb "istio.io/api/security/v1alpha1"
+
 	"istio.io/istio/pkg/security"
 	mockca "istio.io/istio/security/pkg/pki/ca/mock"
+	caerror "istio.io/istio/security/pkg/pki/error"
 
 	fuzz "github.com/AdaLogics/go-fuzz-headers"
 )
@@ -47,6 +50,7 @@ func CreateCertificateFuzz(data []byte) int {
 	if err != nil {
 		return 0
 	}
+	fakeCA.SignErr = caerror.NewError(caerror.CSRError, fmt.Errorf("cannot sign"))
 
 	server := &Server{
 		ca:             fakeCA,
-- 
2.35.3

