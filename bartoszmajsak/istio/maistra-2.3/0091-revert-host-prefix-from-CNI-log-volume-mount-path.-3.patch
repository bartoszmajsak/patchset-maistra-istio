From 8dcf53141d6d50efef56da1506b3d1076a93450a Mon Sep 17 00:00:00 2001
From: Pengyuan Bian <bianpengyuan@google.com>
Date: Thu, 11 Nov 2021 15:14:23 -0800
Subject: revert /host prefix from CNI log volume mount path. (#36038)

---
 cni/pkg/cmd/root.go                                 | 2 +-
 manifests/charts/istio-cni/templates/daemonset.yaml | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/cni/pkg/cmd/root.go b/cni/pkg/cmd/root.go
index a64db2e292..7c8e9aed8c 100644
--- a/cni/pkg/cmd/root.go
+++ b/cni/pkg/cmd/root.go
@@ -137,7 +137,7 @@ func init() {
 	registerStringArrayParameter(constants.SkipCNIBinaries, []string{},
 		"Binaries that should not be installed. Currently Istio only installs one binary `istio-cni`")
 	registerIntegerParameter(constants.MonitoringPort, 15014, "HTTP port to serve prometheus metrics")
-	registerStringParameter(constants.LogUDSAddress, "/host/var/run/istio-cni/log.sock", "The UDS server address which CNI plugin will copy log ouptut to")
+	registerStringParameter(constants.LogUDSAddress, "/var/run/istio-cni/log.sock", "The UDS server address which CNI plugin will copy log ouptut to")
 
 	// Repair
 	registerBooleanParameter(constants.RepairEnabled, true, "Whether to enable race condition repair or not")
diff --git a/manifests/charts/istio-cni/templates/daemonset.yaml b/manifests/charts/istio-cni/templates/daemonset.yaml
index 97d9f0e571..fb83dc76be 100644
--- a/manifests/charts/istio-cni/templates/daemonset.yaml
+++ b/manifests/charts/istio-cni/templates/daemonset.yaml
@@ -126,7 +126,7 @@ spec:
               name: cni-bin-dir
             - mountPath: /host/etc/cni/net.d
               name: cni-net-dir
-            - mountPath: /host/var/run/istio-cni
+            - mountPath: /var/run/istio-cni
               name: cni-log-dir
           resources:
 {{- if .Values.cni.resources }}
-- 
2.35.3

