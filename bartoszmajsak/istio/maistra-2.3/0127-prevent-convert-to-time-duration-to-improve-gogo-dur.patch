From 6c28255cfae25909e966bf933db82d0e3eb00386 Mon Sep 17 00:00:00 2001
From: Zhonghu Xu <xuzhonghu@huawei.com>
Date: Fri, 19 Nov 2021 11:30:45 +0800
Subject: prevent convert to time duration to improve gogo duration convert to
 google duration (#36130)

---
 pilot/pkg/networking/util/util.go | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)

diff --git a/pilot/pkg/networking/util/util.go b/pilot/pkg/networking/util/util.go
index de15120732..461885c1a6 100644
--- a/pilot/pkg/networking/util/util.go
+++ b/pilot/pkg/networking/util/util.go
@@ -235,13 +235,11 @@ func GogoDurationToDuration(d *types.Duration) *durationpb.Duration {
 	if d == nil {
 		return nil
 	}
-	dur, err := types.DurationFromProto(d)
-	if err != nil {
-		// TODO(mostrowski): add error handling instead.
-		log.Warnf("error converting duration %#v, using 0: %v", d, err)
-		return nil
+
+	return &durationpb.Duration{
+		Seconds: d.Seconds,
+		Nanos:   d.Nanos,
 	}
-	return durationpb.New(dur)
 }
 
 // SortVirtualHosts sorts a slice of virtual hosts by name.
-- 
2.35.3

