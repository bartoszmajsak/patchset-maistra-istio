From e363f50d6e1f9cf3935f707afe051c003ccc46a3 Mon Sep 17 00:00:00 2001
From: zirain <hejianpeng2@huawei.com>
Date: Sun, 2 Jan 2022 10:29:34 +0800
Subject: improve accesslog ut (#36679)

---
 pilot/pkg/networking/core/v1alpha3/accesslog_test.go | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/pilot/pkg/networking/core/v1alpha3/accesslog_test.go b/pilot/pkg/networking/core/v1alpha3/accesslog_test.go
index 3cf992adc0..09334473d4 100644
--- a/pilot/pkg/networking/core/v1alpha3/accesslog_test.go
+++ b/pilot/pkg/networking/core/v1alpha3/accesslog_test.go
@@ -123,6 +123,13 @@ func TestListenerAccessLog(t *testing.T) {
 							if len(tcpConfig.AccessLog) < 1 {
 								t.Fatalf("tcp_proxy want at least 1 access log, got 0")
 							}
+
+							for _, tcpAccessLog := range tcpConfig.AccessLog {
+								if tcpAccessLog.Filter != nil {
+									t.Fatalf("tcp_proxy filter chain's accesslog filter must be empty")
+								}
+							}
+
 							// Verify tcp proxy access log.
 							verify(t, tc.encoding, tcpConfig.AccessLog[0], tc.wantFormat)
 						case wellknown.HTTPConnectionManager:
-- 
2.35.3

